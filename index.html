<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify - Your favourite music is here</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');
        
        body{
            background-color: antiquewhite;
            margin: 0;
            padding: 0;
        }

        nav{
            font-family: 'Ubuntu', sans-serif;
        }

        nav ul{
            display: flex;
            align-items: center;
            list-style-type: none;
            height: 65px;
            background-color: black;
            color: white;
            margin: 0;
            padding: 0;
        }

        nav ul li{
            padding: 0 12px;
        }
        
        .brand img{
            width: 44px;
            padding: 0 8px;
        }

        .brand {
            display: flex;
            align-items: center;
            font-weight: bolder;
            font-size: 1.3rem;
        }

        .container{
            min-height: 72vh;
            background-color: black;
            color: white;
            font-family: 'Varela Round', sans-serif;
            display: flex;
            margin: 23px auto;
            width: 70%;
            border-radius: 12px;
            padding: 34px;
            background-image: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        }

        .bottom{
            position: sticky;
            bottom: 0;
            height: 130px;
            background-color: black;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column; 
        }

        .icons{
            margin-top: 14px; 
        }
        
        .icons i{
            cursor: pointer;
            margin: 0 10px;
            font-size: 2rem;
            color: white;
            transition: color 0.3s ease;
        }
        
        .icons i:hover{
            color: #1db954;
        }

        #myProgressBar{
            width: 80vw; 
            cursor: pointer;
            height: 6px;
            background: #404040;
            border-radius: 3px;
            outline: none;
        }

        #myProgressBar::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #1db954;
            cursor: pointer;
        }

        .songItemContainer{
            margin-top: 74px;
            max-height: 400px;
            overflow-y: auto;
        }

        .songItem{
            height: 50px;
            display: flex;
            background-color: white;
            color: black;
            margin: 12px 0;
            justify-content: space-between;
            align-items: center;
            border-radius: 34px;
            transition: transform 0.2s ease;
        }

        .songItem:hover{
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(255,255,255,0.3);
        }

        .songItem img{
            width: 43px;
            height: 43px;
            margin: 0 23px;
            border-radius: 50%;
            object-fit: cover;
        }

        .timestamp{
            margin: 0 23px;
        }

        .timestamp i{
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s ease;
        }
        
        .timestamp i:hover{
            color: #1db954;
        }

        .songInfo{
            position: absolute;
            left: 10vw;
            font-family: 'Varela Round', sans-serif;
            display: flex;
            align-items: center;
        }

        .songInfo img{
            opacity: 0;
            transition: opacity 0.4s ease-in;
            margin-right: 10px;
        }

        .songList h1{
            color: white;
            margin-bottom: 20px;
        }

        .loading{
            text-align: center;
            color: white;
            font-size: 1.2rem;
            margin-top: 50px;
        }

        .error{
            color: #ff6b6b;
            text-align: center;
            margin-top: 20px;
        }

        .play-icon, .pause-icon {
            font-size: 1.2rem;
        }

        @media only screen and (max-width: 1100px) {
            .container {
                width: 90%;
                margin: 10px auto;
                padding: 20px;
            }
            
            .songInfo{
                left: 5vw;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li class="brand">
                <span style="font-size: 2rem; color: #1db954; margin-right: 10px;">‚ô™</span> 
                Spotify
            </li>
            <li>Home</li>
            <li>About</li>
        </ul>
    </nav>

    <div class="container">
        <div class="songList">
            <h1>üéµ Your Music Library</h1>
            <div class="loading" id="loading">Loading your songs...</div>
            <div class="songItemContainer" id="songContainer" style="display: none;">
                <!-- Songs will be dynamically loaded here -->
            </div>
            <div class="error" id="errorMsg" style="display: none;">
                Unable to load songs. Make sure your audio files are in the 'songs' folder.
            </div>
        </div>
        <div class="songBanner"></div>
    </div>

    <div class="bottom">
        <input type="range" name="range" id="myProgressBar" min="0" value="0" max="100">
        <div class="icons">
            <i class="prev-icon" id="previous">‚èÆÔ∏è</i>
            <i class="play-icon" id="masterPlay">‚ñ∂Ô∏è</i>
            <i class="next-icon" id="next">‚è≠Ô∏è</i> 
        </div>
        <div class="songInfo">
            <img src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnlNelY0VuGHzUrYFhHBHQhBl0j4YhDBKmASwCNTkGYxFAcmfh6VEGPIMBCgEAO5IAAA==" width="42px" alt="" id="gif"> 
            <span id="masterSongName">Select a song to play</span>
        </div>
    </div>

    <script>
        console.log("Welcome to Spotify");

        // Initialize variables
        let songIndex = 0;
        let audioElement = new Audio();
        let masterPlay = document.getElementById('masterPlay');
        let myProgressBar = document.getElementById('myProgressBar');
        let gif = document.getElementById('gif');
        let masterSongName = document.getElementById('masterSongName');
        let songs = [];
        let isPlaying = false;

        // Function to discover songs in the songs folder
        async function discoverSongs() {
            const songFiles = [
                '1.mp3', '2.mp3', '3.mp3', '4.mp3', '5.mp3',
                '6.mp3', '7.mp3', '8.mp3', '9.mp3', '10.mp3'
            ];
            
            const defaultSongs = [
                "Warriyo - Mortals [NCS Release]",
                "Cielo - Huma-Huma", 
                "DEAF KEV - Invincible [NCS Release]",
                "Different Heaven & EH!DE - My Heart [NCS Release]",
                "Janji-Heroes-Tonight-feat-Johnning-NCS-Release",
                "Rabba - Salam-e-Ishq",
                "Sakhiyaan - Salam-e-Ishq", 
                "Bhula Dena - Salam-e-Ishq",
                "Tumhari Kasam - Salam-e-Ishq",
                "Na Jaana - Salam-e-Ishq"
            ];

            const validSongs = [];
            
            for (let i = 0; i < songFiles.length; i++) {
                const filePath = `songs/${songFiles[i]}`;
                try {
                    // Test if the audio file exists and is valid
                    const audio = new Audio(filePath);
                    await new Promise((resolve, reject) => {
                        audio.addEventListener('canplaythrough', resolve, { once: true });
                        audio.addEventListener('error', reject, { once: true });
                        audio.preload = 'metadata';
                        audio.load();
                    });
                    
                    validSongs.push({
                        songName: defaultSongs[i] || `Song ${i + 1}`,
                        filePath: filePath,
                        coverPath: `covers/${i + 1}.jpg`
                    });
                } catch (error) {
                    console.log(`Song ${songFiles[i]} not found or invalid`);
                }
            }
            
            return validSongs;
        }

        // Function to create song list UI
        function createSongList(songArray) {
            const container = document.getElementById('songContainer');
            container.innerHTML = '';
            
            songArray.forEach((song, index) => {
                const songItem = document.createElement('div');
                songItem.className = 'songItem';
                songItem.innerHTML = `
                    <img src="${song.coverPath}" alt="Album Cover" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMzMzIiByeD0iMjAiLz4KPHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBzdHlsZT0idHJhbnNmb3JtOiB0cmFuc2xhdGUoMTBweCwgMTBweCkiPgo8cGF0aCBkPSJNOSAxMlY2TDE1IDl2NkwxMiAxNVY5TDYgMTJWNkwxMiA5VjNMNiA2VjEySDE1VjZMMTIgOVYxNVoiIGZpbGw9IiM2NjYiLz4KPC9zdmc+Cjwvc3ZnPg=='">
                    <span class="songName">${song.songName}</span>
                    <span class="songlistplay">
                        <span class="timestamp">
                            <i id="${index}" class="songItemPlay play-icon">‚ñ∂Ô∏è</i>
                        </span>
                    </span>
                `;
                container.appendChild(songItem);
            });
            
            // Add event listeners to play buttons
            document.querySelectorAll('.songItemPlay').forEach(button => {
                button.addEventListener('click', (e) => {
                    const clickedIndex = parseInt(e.target.id);
                    
                    if (songIndex === clickedIndex && isPlaying) {
                        pauseSong();
                    } else {
                        playSong(clickedIndex);
                    }
                });
            });
        }

        // Function to play a song
        function playSong(index) {
            if (songs.length === 0) return;
            
            songIndex = index;
            const song = songs[songIndex];
            
            // Update UI
            updatePlayButtons();
            document.getElementById(songIndex.toString()).textContent = '‚è∏Ô∏è';
            
            // Set audio source and play
            audioElement.src = song.filePath;
            masterSongName.textContent = song.songName;
            audioElement.currentTime = 0;
            
            audioElement.play().then(() => {
                isPlaying = true;
                masterPlay.textContent = '‚è∏Ô∏è';
                gif.style.opacity = 1;
            }).catch(error => {
                console.error('Error playing audio:', error);
                alert(`Cannot play ${song.songName}. File may be missing or corrupted.`);
                resetUI();
            });
        }

        // Function to pause song
        function pauseSong() {
            audioElement.pause();
            isPlaying = false;
            masterPlay.textContent = '‚ñ∂Ô∏è';
            gif.style.opacity = 0;
            updatePlayButtons();
        }

        // Function to update play buttons
        function updatePlayButtons() {
            document.querySelectorAll('.songItemPlay').forEach((button, index) => {
                button.textContent = '‚ñ∂Ô∏è';
            });
        }

        // Function to reset UI
        function resetUI() {
            isPlaying = false;
            masterPlay.textContent = '‚ñ∂Ô∏è';
            gif.style.opacity = 0;
            updatePlayButtons();
        }

        // Master play button event
        masterPlay.addEventListener('click', () => {
            if (songs.length === 0) return;
            
            if (isPlaying) {
                pauseSong();
            } else {
                if (audioElement.src) {
                    audioElement.play().then(() => {
                        isPlaying = true;
                        masterPlay.textContent = '‚è∏Ô∏è';
                        gif.style.opacity = 1;
                        document.getElementById(songIndex.toString()).textContent = '‚è∏Ô∏è';
                    }).catch(error => {
                        console.error('Error playing audio:', error);
                    });
                } else {
                    playSong(0);
                }
            }
        });

        // Progress bar event
        audioElement.addEventListener('timeupdate', () => {
            if (audioElement.duration) {
                const progress = (audioElement.currentTime / audioElement.duration) * 100;
                myProgressBar.value = progress;
            }
        });

        myProgressBar.addEventListener('input', () => {
            if (audioElement.duration) {
                audioElement.currentTime = (myProgressBar.value * audioElement.duration) / 100;
            }
        });

        // Next button
        document.getElementById('next').addEventListener('click', () => {
            if (songs.length === 0) return;
            
            songIndex = (songIndex + 1) % songs.length;
            playSong(songIndex);
        });

        // Previous button
        document.getElementById('previous').addEventListener('click', () => {
            if (songs.length === 0) return;
            
            songIndex = songIndex === 0 ? songs.length - 1 : songIndex - 1;
            playSong(songIndex);
        });

        // Auto play next song
        audioElement.addEventListener('ended', () => {
            songIndex = (songIndex + 1) % songs.length;
            playSong(songIndex);
        });

        // Initialize the app
        async function initializeApp() {
            try {
                document.getElementById('loading').textContent = 'Scanning for music files...';
                songs = await discoverSongs();
                
                if (songs.length > 0) {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('songContainer').style.display = 'block';
                    createSongList(songs);
                    console.log(`Found ${songs.length} songs:`, songs.map(s => s.songName));
                } else {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('errorMsg').style.display = 'block';
                    console.log('No valid audio files found in songs folder');
                }
            } catch (error) {
                console.error('Error initializing app:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('errorMsg').style.display = 'block';
            }
        }

        // Start the app
        initializeApp();
    </script>
</body>
</html>